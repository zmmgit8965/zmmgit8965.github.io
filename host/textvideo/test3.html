<!DOCTYPE html> 
<html> 
<body> 

    <div style="display:none;">
<video width="400" controls>
  <source src="BadApple.mp4" type="video/mp4">
  Your browser does not support HTML5 video.
</video>
</div>
<canvas id="canvas" height="500" height="500"></canvas>
<p>These are the frames' images generated by getVideoImage():</p>
<ol id="olFrames"></ol>

<script type="text/JavaScript">
function getVideoImage(path, secs, callback) {
  var me = this, video = document.createElement('video');
  video.onloadedmetadata = function() {
    if ('function' === typeof secs) {
      secs = secs(this.duration);
    }
    this.currentTime = Math.min(Math.max(0, (secs < 0 ? this.duration : 0) + secs), this.duration);
  };
  video.onseeked = function(e) {
    var canvas = document.getElementById('canvas');
    canvas.height = video.videoHeight;
    canvas.width = video.videoWidth;
    var ctx = canvas.getContext('2d');
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
    //var img = new Image();
    //img.src = canvas.toDataURL();
    var img = canvas.getContext("2d").getImageData(0,0,500,500);
    callback.call(me, img, this.currentTime, e);
  };
  video.onerror = function(e) {
    callback.call(me, undefined, undefined, e);
  };
  video.src = path;
}
function showImageAt(secs) {
  var duration;
  getVideoImage(
    'BadApple.mp4',
    function(totalTime) {
      duration = totalTime;
      return secs;
    },
    function(img, secs, event) {
      if (event.type == 'seeked') {
        var arr = [];
        for(var i=0 ; i<500; i++){
          var row = [];
          for(var j=0 ; j<500; j++){
            var v = getPixcelValue(img,i,j);
            if(v > 100){
              row.push(0);
            }else{
              row.push(1);
            }
          }
          arr.push(row);
        }
        showText(arr);
        // var li = document.createElement('li');
        // li.innerHTML += '<b>Frame at second ' + secs + ':</b><br />';
        // li.appendChild(img);
        // document.getElementById('olFrames').appendChild(li);
        if (duration >= ++secs) {
          showImageAt(secs);
        };
      }
    }
  );
}

function showText(arr){
  var s = [];
  for(var i=0 ; i<500; i=i+8){
    for(var j=0 ; j<500; j=j+8){
      if(arr[i][j] == 0){
        s.push("l")
      }else{
        s.push("w");
      }
    }
    s.push("\r\n");
  }
  document.getElementById("tt").value = s.join("");
}

function getPixcelValue(img,x,y){
    var n = (x*500+y)*4;
    var r = img.data[n];
    var g = img.data[n+1];
    var b = img.data[n+2]; 
    return (r+g+b) / 3
}

showImageAt(0);
</script>
  
<p>
Video courtesy of 
<a href="https://www.bigbuckbunny.org/" target="_blank">Big Buck Bunny</a>.
<textarea id="tt" style="width:500px;height:500px;overflow:hidden">
lllllwwww
</textarea>
</p>
</body> 
</html>
